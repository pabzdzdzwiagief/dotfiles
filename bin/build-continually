#!/usr/bin/env bash

[[ $1 == "--help" ]] && echo """\
Usage: build-continually [FILE] [COMMAND]
Execute COMMAND ("make" by default) every time FILE (the current directory by
default) changes.""" && exit 0

inotifywait --format "%w%f" -e modify -rmq ${1:-`pwd -L`} |
while read modified
do
    echo -en "\e[1;30m[$(date --rfc-3339=seconds)] "
    echo -en "\e[1;33m$modified"
    echo -e  "\e[00m"
    ${2:-make}
done
